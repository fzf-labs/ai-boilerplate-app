# /prd-to-test - PRD 生成测试用例

## 描述
从产品需求文档（PRD）生成全面的测试用例，包括功能测试、边界值测试、UI/UX测试等多种测试场景，确保需求完整覆盖。

## 使用方式
```
/prd-to-test <PRD文档路径> [--format <输出格式>] [--output <输出路径>]
```

## 参数说明
- `PRD文档路径`: PRD 文档的路径（支持 .md 或 .txt 格式）
- `--format`: 测试用例输出格式
  - `markdown` (默认): Markdown 表格格式
  - `excel`: Excel 表格格式（.xlsx）
  - `testcase`: 标准测试用例格式
  - `json`: JSON 格式（用于自动化测试集成）
- `--output`: 指定输出文件路径（默认保存到 `testcases/` 目录）

## 测试用例类型

### 1. 功能测试用例
**目的**: 验证功能需求是否正确实现

**包含内容**:
- 基于用户故事的场景测试
- 正常流程测试
- 异常流程测试
- 权限控制测试
- 数据验证测试

**示例**:
```markdown
| 用例ID | 功能模块 | 测试场景 | 前置条件 | 测试步骤 | 预期结果 | 优先级 |
|--------|---------|---------|---------|---------|---------|--------|
| TC001  | 用户登录 | 正常登录 | 用户已注册 | 1. 输入用户名<br>2. 输入密码<br>3. 点击登录 | 登录成功，跳转首页 | P0 |
| TC002  | 用户登录 | 密码错误 | 用户已注册 | 1. 输入用户名<br>2. 输入错误密码<br>3. 点击登录 | 提示"密码错误" | P0 |
```

### 2. 边界值测试用例
**目的**: 验证输入边界和极端情况

**测试维度**:
- 字符串长度（空、最小、最大、超长）
- 数值范围（负数、零、最小值、最大值、超限）
- 日期时间（过去、当前、未来、特殊日期）
- 数组列表（空、单个、最大数量）
- 特殊字符（SQL注入、XSS、emoji）

**示例**:
```markdown
| 用例ID | 测试项 | 输入值 | 边界类型 | 预期结果 | 优先级 |
|--------|-------|--------|---------|---------|--------|
| BV001  | 用户名 | "" | 空值 | 提示"用户名不能为空" | P1 |
| BV002  | 用户名 | "a" | 最小长度 | 通过验证（假设最小长度=1） | P1 |
| BV003  | 用户名 | "a"*50 | 最大长度 | 通过验证（假设最大长度=50） | P1 |
| BV004  | 用户名 | "a"*51 | 超长 | 提示"用户名不能超过50个字符" | P1 |
| BV005  | 年龄 | -1 | 负数 | 提示"年龄必须为正数" | P1 |
| BV006  | 年龄 | 0 | 零值 | 根据业务规则判断 | P1 |
| BV007  | 年龄 | 150 | 超限值 | 提示"年龄超出合理范围" | P2 |
```

### 3. UI/UX 测试用例
**目的**: 验证用户界面和用户体验

**测试方面**:
- 页面布局和响应式设计
- 交互反馈（按钮状态、loading、toast）
- 错误提示和引导
- 无障碍访问（键盘操作、屏幕阅读器）
- 多语言和国际化
- 多浏览器兼容性

**示例**:
```markdown
| 用例ID | 测试项 | 测试场景 | 验证点 | 预期结果 | 优先级 |
|--------|-------|---------|--------|---------|--------|
| UI001  | 登录按钮 | 点击反馈 | 按钮状态变化 | 点击后按钮变为禁用状态，显示loading | P0 |
| UI002  | 表单验证 | 实时提示 | 错误提示展示 | 输入框失焦时立即显示错误提示 | P1 |
| UI003  | 响应式布局 | 移动端适配 | 布局自适应 | 在375px宽度下布局正常，无横向滚动 | P1 |
| UI004  | 键盘操作 | Tab键导航 | 焦点顺序 | Tab键按逻辑顺序切换焦点 | P2 |
```

### 4. 性能测试用例
**目的**: 验证性能指标和用户体验

**测试指标**:
- 页面加载时间
- API 响应时间
- 并发用户数
- 大数据量处理
- 资源消耗（内存、CPU）

**示例**:
```markdown
| 用例ID | 测试项 | 测试条件 | 性能指标 | 预期结果 | 优先级 |
|--------|-------|---------|---------|---------|--------|
| PF001  | 首页加载 | 正常网络 | FCP | < 1.5秒 | P1 |
| PF002  | 用户列表 | 10000条数据 | 渲染时间 | < 2秒 | P1 |
| PF003  | 搜索接口 | 100并发 | 响应时间 | 95%请求 < 500ms | P2 |
```

### 5. 安全测试用例
**目的**: 验证安全性和数据保护

**测试维度**:
- 认证授权
- 数据加密
- SQL 注入
- XSS 攻击
- CSRF 防护
- 敏感数据保护

**示例**:
```markdown
| 用例ID | 测试项 | 攻击场景 | 测试步骤 | 预期结果 | 优先级 |
|--------|-------|---------|---------|---------|--------|
| SEC001 | 登录接口 | SQL注入 | 用户名输入: `' OR '1'='1` | 返回错误，不执行SQL | P0 |
| SEC002 | 评论功能 | XSS攻击 | 输入: `<script>alert('xss')</script>` | 内容被转义，不执行脚本 | P0 |
| SEC003 | 密码存储 | 数据泄露 | 查看数据库密码字段 | 密码已加密存储（bcrypt等） | P0 |
```

### 6. 兼容性测试用例
**目的**: 验证跨平台和跨设备兼容性

**测试范围**:
- 浏览器兼容性（Chrome、Safari、Firefox、Edge）
- 操作系统（Windows、macOS、iOS、Android）
- 设备类型（桌面、平板、手机）
- 屏幕尺寸和分辨率

**示例**:
```markdown
| 用例ID | 测试项 | 平台/设备 | 测试场景 | 预期结果 | 优先级 |
|--------|-------|----------|---------|---------|--------|
| CP001  | 页面布局 | Chrome 最新版 | 正常浏览 | 布局正常，功能可用 | P0 |
| CP002  | 页面布局 | Safari iOS | iPhone 13 | 布局正常，触摸交互流畅 | P0 |
| CP003  | 文件上传 | Android 12 | 选择图片上传 | 可正常选择和上传 | P1 |
```

## 测试用例格式

### Markdown 格式（默认）
```markdown
# 测试用例文档

## 功能名称

**PRD 来源**: docs/user-management-prd.md
**生成时间**: 2024-01-15
**版本**: v1.0

## 1. 功能测试用例

### 1.1 用户登录

| 用例ID | 测试场景 | 前置条件 | 测试步骤 | 预期结果 | 优先级 |
|--------|---------|---------|---------|---------|--------|
| ...    | ...     | ...     | ...     | ...     | ...    |

## 2. 边界值测试用例
...

## 3. UI/UX 测试用例
...
```

### Excel 格式
生成标准 Excel 文件，包含多个 Sheet：
- Sheet 1: 功能测试用例
- Sheet 2: 边界值测试用例
- Sheet 3: UI/UX 测试用例
- Sheet 4: 性能测试用例
- Sheet 5: 安全测试用例
- Sheet 6: 兼容性测试用例

### JSON 格式（用于自动化）
```json
{
  "metadata": {
    "prd_source": "docs/user-management-prd.md",
    "generated_at": "2024-01-15T10:30:00Z",
    "version": "v1.0"
  },
  "testcases": [
    {
      "id": "TC001",
      "type": "functional",
      "module": "用户登录",
      "scenario": "正常登录",
      "preconditions": "用户已注册",
      "steps": [
        "输入用户名",
        "输入密码",
        "点击登录"
      ],
      "expected": "登录成功，跳转首页",
      "priority": "P0"
    }
  ]
}
```

## 执行流程

### 阶段 1：分析 PRD 文档
1. 读取并解析 PRD 文档
2. 提取关键信息：
   - 功能需求列表
   - 用户故事
   - 验收标准
   - 技术约束
   - 非功能性需求
3. 识别测试范围和优先级

### 阶段 2：生成测试用例
1. **功能测试用例**：基于每个功能需求和用户故事
2. **边界值测试用例**：分析输入字段，生成边界测试
3. **UI/UX 测试用例**：基于界面原型和交互设计
4. **性能测试用例**：基于性能指标要求
5. **安全测试用例**：基于安全需求和最佳实践
6. **兼容性测试用例**：基于目标平台和设备

### 阶段 3：优先级排序
- **P0（高优先级）**：核心功能、安全性、阻塞性问题
- **P1（中优先级）**：重要功能、边界情况、体验问题
- **P2（低优先级）**：边缘场景、锦上添花的功能

### 阶段 4：输出和保存
1. 按指定格式生成测试用例文档
2. 保存到指定路径
3. 生成测试覆盖率报告
4. 提供测试执行建议

## 使用示例

### 示例 1：基础用法
```bash
用户: /prd-to-test docs/user-management-prd.md

助手:
📄 正在分析 PRD 文档...
✅ 识别到 5 个主要功能模块
✅ 提取到 12 个用户故事

📝 生成测试用例中...
✅ 功能测试用例: 45 条
✅ 边界值测试用例: 28 条
✅ UI/UX 测试用例: 15 条
✅ 性能测试用例: 8 条
✅ 安全测试用例: 12 条
✅ 兼容性测试用例: 6 条

总计: 114 条测试用例

📊 测试覆盖率分析:
- 功能需求覆盖: 100%
- 用户故事覆盖: 100%
- 边界场景覆盖: 90%
- 安全风险覆盖: 85%

💾 测试用例已保存至: testcases/user-management-testcases.md
```

### 示例 2：指定格式和输出路径
```bash
用户: /prd-to-test docs/order-system-prd.md --format excel --output test-cases/order-system.xlsx

助手:
📄 正在分析 PRD 文档...
✅ 识别到 8 个主要功能模块
✅ 提取到 24 个用户故事

📝 生成 Excel 格式测试用例...
✅ Sheet 1: 功能测试用例 (68条)
✅ Sheet 2: 边界值测试用例 (42条)
✅ Sheet 3: UI/UX 测试用例 (25条)
✅ Sheet 4: 性能测试用例 (12条)
✅ Sheet 5: 安全测试用例 (18条)
✅ Sheet 6: 兼容性测试用例 (10条)

💾 测试用例已保存至: test-cases/order-system.xlsx
```

### 示例 3：生成 JSON 格式用于自动化测试
```bash
用户: /prd-to-test docs/payment-gateway-prd.md --format json

助手:
📄 正在分析 PRD 文档...
✅ 识别到 6 个主要功能模块
✅ 提取到 18 个用户故事

📝 生成 JSON 格式测试用例...
✅ 结构化测试用例: 95 条
✅ 包含自动化测试脚本模板

💾 测试用例已保存至: testcases/payment-gateway-testcases.json

💡 提示: 该 JSON 文件可直接导入到自动化测试框架（如 Jest、Playwright、Cypress）
```

## 测试用例质量标准

### 完整性检查
- ✅ 每个功能需求都有对应的测试用例
- ✅ 每个用户故事都有正常和异常场景
- ✅ 所有输入字段都有边界值测试
- ✅ 关键流程都有端到端测试

### 清晰性检查
- ✅ 测试步骤明确，可执行
- ✅ 预期结果具体，可验证
- ✅ 前置条件清晰列出
- ✅ 测试数据准备说明完整

### 可维护性检查
- ✅ 用例 ID 有统一的命名规范
- ✅ 测试场景分类清晰
- ✅ 优先级标注合理
- ✅ 支持版本管理和追踪

## 输出文件结构

```
testcases/
├── {功能名}-testcases.md           # Markdown 格式测试用例
├── {功能名}-testcases.xlsx         # Excel 格式测试用例
├── {功能名}-testcases.json         # JSON 格式测试用例
└── coverage-report.md              # 测试覆盖率报告
```

## 测试覆盖率报告

生成的覆盖率报告包含：

```markdown
# 测试覆盖率报告

## 功能需求覆盖率
| 功能模块 | 需求数量 | 覆盖用例数 | 覆盖率 |
|---------|---------|-----------|--------|
| 用户登录 | 5       | 5         | 100%   |
| 用户注册 | 8       | 8         | 100%   |
| ...     | ...     | ...       | ...    |

## 用户故事覆盖率
| 用户故事 | 正常场景 | 异常场景 | 边界场景 | 覆盖率 |
|---------|---------|---------|---------|--------|
| US001   | ✅      | ✅      | ✅      | 100%   |
| US002   | ✅      | ✅      | ⚠️      | 66%    |

## 测试类型分布
- 功能测试: 40%
- 边界值测试: 25%
- UI/UX测试: 15%
- 性能测试: 10%
- 安全测试: 7%
- 兼容性测试: 3%
```

## 最佳实践

### 1. PRD 文档准备
- 确保 PRD 包含清晰的功能需求和验收标准
- 提供详细的用户故事和使用场景
- 明确列出输入字段和验证规则
- 说明性能要求和安全约束

### 2. 测试用例设计原则
- **可执行性**: 步骤清晰，任何人都能执行
- **可重复性**: 每次执行结果一致
- **独立性**: 测试用例之间不相互依赖
- **可追溯性**: 能追溯到对应的需求

### 3. 优先级分配建议
- **P0**: 核心功能、支付、安全、数据准确性
- **P1**: 重要功能、用户体验、常见场景
- **P2**: 边缘场景、非关键功能、锦上添花

### 4. 持续维护
- PRD 更新后重新生成测试用例
- 测试执行后补充遗漏场景
- 缺陷修复后添加回归测试
- 定期审查和优化测试用例

## 相关命令

- `/requirement` - 生成 PRD 文档
- `/test` - 为代码生成单元测试
- `/dev` - 开发流程（包含测试环节）
- `/check` - 代码检查和测试运行

## 注意事项

1. 测试用例生成质量依赖于 PRD 质量
2. 建议在 PRD 完成后立即生成测试用例
3. 测试用例可作为开发验收的依据
4. 生成的测试用例可根据实际情况调整
5. 自动化测试可基于生成的 JSON 格式实现
6. 定期回顾和更新测试用例，保持与需求同步

## 技能调用

此命令会调用 `prd-to-testcase` 技能，该技能提供：
- PRD 文档智能解析
- 多维度测试用例生成
- 标准化测试用例格式
- 测试覆盖率分析
- 质量保证机制
